# Display the plot
print(p)
p <- ggplot(merge_data_p3, aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
#geom_hline(data = average_popularity, aes(yintercept = avg_popularity, color = band_ended), linetype = "dashed", size = 1, show.legend = TRUE) +
scale_x_date(date_breaks = "years", date_labels = "%Y") +
labs(title = "Track Popularity Over Album Release Dates",
x = "Album Release Date",
y = "Track Popularity") +
theme_minimal() +
geom_smooth(method = "lm", se = FALSE)
# Display the plot
p
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr) #for stat_cor
library(corrplot) #for correlation table
library(plotly) #making the ggplot interactive
library(viridis) #scale color viridis
library(hrbrthemes)
library(dplyr)
library(knitr) #For printing table of Outlier Summary
library(patchwork)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black"),
axis.text.x = element_text(angle = 90)) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.ticks.x = element_text(angle = 90),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
artist_info_ranking <- readRDS("artist_info_ranking.rds")
top_tracks_us <- readRDS("top_tracks_us.rds")
mbdata <- readRDS("./data/mbdata.rds")
#Selecting the necessary variables from each of the datasets
subset_mbdata <- mbdata %>% select(artist_spotify, Begin, End)
subset_artist_info_ranking <- artist_info_ranking %>% select(artist_spotify, artist_id = id, popularity)
subset_top_tracks_us <- top_tracks_us %>% select(artist_spotify, artist_id, track_name, track_id, track_popularity, album.release_date)
merge_data_p3 <- merge(subset_mbdata, subset_artist_info_ranking, by = "artist_spotify")
merge_data_p3 <- merge(merge_data_p3, subset_top_tracks_us, by = "artist_id")
# Convert dates to Date objects
merge_data_p3$Begin <- as.Date(merge_data_p3$Begin)
merge_data_p3$End <- as.Date(merge_data_p3$End)
merge_data_p3$album.release_date <- as.Date(merge_data_p3$album.release_date)
merge_data_p3$band_ended <- ifelse(merge_data_p3$End < merge_data_p3$album.release_date, "Artist not Active", "Regular Release")
merge_data_p3$band_ended[is.na(merge_data_p3$band_ended)] <- "Regular Release"
merge_data_p3$is_pop <- ifelse(merge_data_p3$popularity > 50, "Popular Artist", "Unpopular Artist")
average_popularity <- merge_data_p3 %>%
group_by(band_ended) %>%
summarise(avg_popularity = mean(popularity))
plot_data <- merge_data_p3 %>% filter(!is.na(album.release_date))
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.ticks.x = element_text(angle = 90),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p3, p2, ncol = 2)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 90),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
grid.arrange(p3, p2, ncol = 2)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
grid.arrange(p3, p2, ncol = 2)
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p3, p2, ncol = 2)
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 0, vjust = 0),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 0, vjust = 0),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p3, p2, ncol = 2)
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 0, vjust = 0),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1, vjust = .5),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p3, p2, ncol = 2)
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "For 'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p2, p3, ncol = 2)
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p2, p3, ncol = 2)
artist_info_ranking <- readRDS("artist_info_ranking.rds")
top_tracks_us <- readRDS("top_tracks_us.rds")
mbdata <- readRDS("./data/mbdata.rds")
#Selecting the necessary variables from each of the datasets
subset_mbdata <- mbdata %>% select(artist_spotify, Begin, End)
subset_artist_info_ranking <- artist_info_ranking %>% select(artist_spotify, artist_id = id, popularity)
subset_top_tracks_us <- top_tracks_us %>% select(artist_spotify, artist_id, track_name, track_id, track_popularity, album.release_date)
merge_data_p3 <- merge(subset_mbdata, subset_artist_info_ranking, by = "artist_spotify")
merge_data_p3 <- merge(merge_data_p3, subset_top_tracks_us, by = "artist_id")
# Convert dates to Date objects
merge_data_p3$Begin <- as.Date(merge_data_p3$Begin)
merge_data_p3$End <- as.Date(merge_data_p3$End)
merge_data_p3$album.release_date <- as.Date(merge_data_p3$album.release_date)
merge_data_p3$band_ended <- ifelse(merge_data_p3$End < merge_data_p3$album.release_date, "Release of Non Active Artist", "Regular Release")
merge_data_p3$band_ended[is.na(merge_data_p3$band_ended)] <- "Regular Release"
merge_data_p3$is_pop <- ifelse(merge_data_p3$popularity > 50, "Popular Artist", "Unpopular Artist")
average_popularity <- merge_data_p3 %>%
group_by(band_ended) %>%
summarise(avg_popularity = mean(popularity))
plot_data <- merge_data_p3 %>% filter(!is.na(album.release_date))
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p2, p3, ncol = 2)
# Create the plot for band_ended facet
p2 <- ggplot(plot_data %>% filter(is_pop == "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Popular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
geom_smooth(method = "lm", se = FALSE) +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
p3 <- ggplot(plot_data %>% filter(is_pop != "Popular Artist"), aes(x = album.release_date, y = track_popularity, color = band_ended)) +
geom_point(size = 3, alpha = 0.7) +
scale_x_date(date_breaks = "5 years", date_labels = "%Y", limits = c(as.Date("1958-01-01"), as.Date("2023-12-12") )) +
labs(title = "Track Popularity Over Album Release Dates",
subtitle = "'Unpopular' Artists",
x = "Album Release Date",
y = "Track Popularity",
color = "") +
theme_minimal() +
ylim(0,100) +
#xlim(as.Date("1960-01-01"), NA) +
geom_smooth(method = "lm", se = FALSE)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(linetype = "dashed"),
panel.grid.major.y = element_line(linetype = "dashed"),
plot.title = element_text(size = 16, hjust = 0.5, color = "black", face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black")) +
geom_hline(aes(yintercept = 0), linetype = "solid", color = "black", alpha = 0.5)
# Display the plots side by side
library(gridExtra)
grid.arrange(p2, p3, ncol = 2)
# this chunk generates the complete code appendix.
# eval=FALSE tells R not to run (``evaluate'') the code here (it was already run before).
rs_ranking <- read.csv("rs_ranking.csv")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr) #for stat_cor
library(corrplot) #for correlation table
library(plotly) #making the ggplot interactive
library(viridis) #scale color viridis
library(hrbrthemes)
library(dplyr)
library(knitr) #For printing table of Outlier Summary
library(patchwork)
#################### Final Packages
library(rvest)
library(dplyr)
library(RSelenium)
library(spotifyr)
library("jsonlite")
library(dplyr)
readRenviron("api.env")
client_id <- Sys.getenv("SPOTIFY_CLIENT_ID")
client_secret <- Sys.getenv("SPOTIFY_CLIENT_SECRET")
access_token <- get_spotify_access_token(client_id, client_secret)
